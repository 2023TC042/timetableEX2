:root{
  --gap: 1px;
  --header-height: 56px;
  --side-label-width: 64px;
  --topbar-bg: #0b5cff;
  --cell-bg: #ffffff;
  --grid-line: #ccc;
  --accent: #0b5cff;
  --danger: #e04b4b;
}

/* 全体 */
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:system-ui,-apple-system,"Segoe UI","Noto Sans JP","Hiragino Kaku Gothic ProN",sans-serif}
body{display:flex;flex-direction:column;background:#f3f5f7;color:#111}

.topbar{
  height:var(--header-height);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 12px;
  background:linear-gradient(180deg,var(--topbar-bg),#0a4bd6);
  color:#fff;
  flex:0 0 var(--header-height);
}
.title{margin:0;font-size:1.1rem}
.btn{
  background:#fff;color:var(--topbar-bg);
  border:none;padding:8px 12px;border-radius:6px;font-weight:600;cursor:pointer;
}
.btn.primary{background:var(--accent);color:#fff}
.btn.danger{background:var(--danger);color:#fff}

main{flex:1;display:flex;align-items:stretch;justify-content:center;padding:8px}

.timetable{
  width:100%;
  height:100%;
  max-width:1200px;
  display:grid;
  grid-template-columns: var(--side-label-width) repeat(6,1fr); /* 6列: 月〜土 */
  grid-template-rows: 40px repeat(6, 1fr); /* 6時限 */
  gap: var(--gap);
  background:var(--grid-line);
  border-radius:8px;
  overflow:auto; /* 内部スクロールにする */
  max-height: calc(100vh - var(--header-height) - 16px);
  padding:4px;
}


.header-cell{
  background:linear-gradient(180deg,#fff,#f7f9fc);
  display:flex;align-items:center;justify-content:center;
  font-weight:700;padding:6px;
}

.corner{
  background:#fafafa;display:flex;align-items:center;justify-content:center;font-weight:600;
}

.period-cell{
  background:#fff;display:flex;align-items:center;justify-content:center;font-weight:600;
}

.slot{
  background:var(--cell-bg);
  padding:6px;
  min-height:0; /* for flex children inside grid */
  display:flex;flex-direction:column;justify-content:center;align-items:flex-start;
  cursor:default;
  overflow:hidden;
  border-radius:6px;
  box-shadow: 0 1px 0 rgba(0,0,0,0.03);
}
.slot.editable{cursor:pointer}
.slot .subject{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.slot .meta{font-size:0.85rem;color:#555;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:4px}

.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:1000}
.modal[aria-hidden="false"]{display:flex}
.modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,0.35)}
.modal-panel{
  position:relative;background:#fff;border-radius:10px;padding:18px;width:min(640px,95%);z-index:2;
  box-shadow:0 10px 30px rgba(0,0,0,0.2); max-height: calc(100vh - 80px); overflow:auto;
}
.form-row{margin-bottom:10px}
.form-row input{width:100%;padding:8px;border:1px solid #ddd;border-radius:6px}
.modal-actions{display:flex;align-items:center;margin-top:8px}
.spacer{flex:1}

.view-info{margin-bottom:12px}
.view-info div{margin:6px 0}
.reports{margin-top:8px}
.reports-grid{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap:8px;
  margin-top:8px;
}
.report-item{display:flex;align-items:center;gap:8px;padding:6px;border:1px solid #eee;border-radius:6px;background:#fafafa}
.report-item input{width:18px;height:18px}

.timetable.editing .slot{background:#fff}
.timetable.editing .slot.editable{outline:2px dashed rgba(11,92,255,0.18)}

@media (max-width: 760px), (orientation: portrait) {
  :root{
    --side-label-width: 48px;
  }

  .timetable{
    display:block;
    max-width: 720px;
    padding:6px;
    border-radius:0;
    background:transparent;
  }

  .timetable .header-cell,
  .timetable .period-cell,
  .timetable .corner{
    display:none;
  }

  .timetable .slot{
    display:flex;
    flex-direction:column;
    gap:6px;
    margin:6px 0;
    padding:10px;
    border-radius:10px;
    background:#fff;
    box-shadow:0 6px 18px rgba(0,0,0,0.06);
    min-height: 48px;
  }

  .timetable .slot::before{
    content: attr(data-day) " " attr(data-period) "限";
    display:block;
    font-weight:700;
    color:#0b5cff;
    margin-bottom:6px;
    font-size:0.95rem;
  }

  .slot .subject{font-size:1rem}
  .slot .meta{font-size:0.9rem;color:#666}

  .modal-panel{
    width: calc(100% - 12px);
    height: calc(100vh - 12px);
    max-height: calc(100vh - 12px);
    border-radius:10px;
    padding:12px;
  }
}

@media (max-height:600px){
  .timetable{grid-template-rows: 36px repeat(6, minmax(36px,1fr))}
  .title{font-size:0.95rem}
}
